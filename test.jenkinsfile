#!groovy
//definir los servidores
/* groovylint-disable-next-line CompileStatic */
//def hostsIPsMap = [
  //      '10.21.61.182': '10.21.61.182',
    //    '10.21.61.183': '10.21.61.183',
    //    '10.21.61.184': '10.21.61.184',
    //    '10.20.73.20' : '10.20.73.20',
    //    '10.20.73.21' : '10.20.73.21',
    //    '10.20.73.22' : '10.20.73.22'
]
def SERVER_DEPLOY = null
SERVER_DEPLOY = [env.seleccione_ambiente]

pipeline {
    agent any
    //environment {
    //branch="${branch}"
    //credentiales = credentials('jenkinsfuseqa')
    //IPFUSEQA5 = '10.10.10.10'
    ipfuseq5_server1="${env,ip-fuse-q5-server1}"
    ipfuseq5_server2="${env.ip-fuse-q5-server2}"
    ipfuseq5_server3="${env.ip-fuse-q5-server3}"
    //pathfuse="${env.pathfuse}"
    //profile="${env.perfil_fuse}"
    //propertiesboolean="${env.cargarproperties}"
    //nexusurl="http://10.20.78.193:8081/nexus/content/repositories/jboss-fuse-qa"
    //redhatgaurl="http://10.20.78.193:8081/nexus/content/repositories/redhat-ga-repository/"
    //reponame="wsevaluacionsolicitudesweb"
    //jobname="${env.JOB_NAME}"
    //repobash="storage"
    //namesonar="wsevaluacionsolicitudeswebqa"
    //ambiente="qa"
    //}
      stages {
        stage('Clone') {
          steps {
            script {
              if ("${SERVER_DEPLOY}" == 'Q5A') {
                dir('labslocal') {
                  git branch: 'testing', url: 'https://github.com/Pirhnvag/labslocal.git'
                    sh '''
                      echo realizando ssh en servidor  $ipfuseq5_server1 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando ssh en servidor  $ipfuseq5_server2 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando ssh en servidor  $ipfuseq5_server3 ambiente $seleccione_ambiente
                       '''
            }
          }
        }
      }
    }
      stage('Deploy Fuse') {
        steps {
          script {
            print ('Despliegue artefactos en Servidor FUSE')
              if ("${SERVER_DEPLOY}" == 'Q5A') {
                sh '''
                      echo realizando despliegue en servidor  $ipfuseq5_server1 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando despliegue en servidor  $ipfuseq5_server2 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando despliegue en servidor  $ipfuseq5_server3 ambiente $seleccione_ambiente
                   '''
              }
            }
          }
        }
      }
    }