#!groovy
//definir los servidores

/* groovylint-disable-next-line CompileStatic */
//def hostsIPsMap = [
  //      '10.21.61.182': '10.21.61.182',
    //    '10.21.61.183': '10.21.61.183',
    //    '10.21.61.184': '10.21.61.184',
    //    '10.20.73.20' : '10.20.73.20',
    //    '10.20.73.21' : '10.20.73.21',
    //    '10.20.73.22' : '10.20.73.22'
//]
def SERVER_DEPLOY = null
SERVER_DEPLOY = [env.seleccione_ambiente]

def PERFIL_FUSE = null
PERFIL_FUSE = [env.perfil_fuse]
def PROFILE = '$SERVER_DEPLOY'+'$PERFIL_FUSE'

pipeline {
    agent any
      environment {
    //branch="${branch}"
    //credentiales = credentials('jenkinsfuseqa')
    //IPFUSEQA5 = '10.10.10.10'
      ipfuseq5_1= "${ipfuseq5a1}"
      ipfuseq5_2= "${ipfuseq5b2}"
      ipfuseq5_3= "${ipfuseq5c3}"
      //profile="${perfil_fuse}"
      //ipfusetest= '11.11.11.11'
      //ipfuseq5b = "${env.ip-fuse-q5b2}"
    //ipfuseq5c = "${env.ip-fuse-q5c3}"
    //pathfuse="${env.pathfuse}"
    profile="$PROFILE"
    //propertiesboolean="${env.cargarproperties}"
    //nexusurl="http://10.20.78.193:8081/nexus/content/repositories/jboss-fuse-qa"
    //redhatgaurl="http://10.20.78.193:8081/nexus/content/repositories/redhat-ga-repository/"
    //reponame="wsevaluacionsolicitudesweb"
    //jobname="${env.JOB_NAME}"
    //repobash="storage"
    //namesonar="wsevaluacionsolicitudeswebqa"
    //ambiente="qa"
    }
      stages {
        stage('Clone') {
          steps {
            script {
              if ("$seleccione_ambiente" == 'q5a') {
                dir('labslocal') {
                  git branch: 'testing', url: 'https://github.com/Pirhnvag/labslocal.git'
                    sh '''
                      echo $profile
                       '''
            }
           
            dir('labslocal') {
                  git branch: 'testing', url: 'https://github.com/Pirhnvag/labspirhnvag.git'
                    sh '''
                      echo clone de repositorio secundario de prueba
                       '''
            }
          }
        }
      }
    }
      stage('Deploy Fuse') {
        steps {
          script {
            print ('Despliegue artefactos en Servidor FUSE')
              if ("$seleccione_ambiente" == 'Q5A') {
                sh '''
                      echo realizando despliegue en servidor  $ipfuseq5_1 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando despliegue en servidor  $ipfuseq5_2 ambiente $seleccione_ambiente
                      sleep 3
                      echo realizando despliegue en servidor  $ipfuseq5_3 ambiente $seleccione_ambiente
                   '''
              }
            }
          }
        }
        stage('Capture env perfil fuse') {
        steps {
          script {
            sh '''
              echo $perfil_fuse
              echo $profile
              '''
           }
         }
       }
     }
   }